using System;
using System.Collections.Generic;
using System.Text;
using System.Data;
using Bzw.Data;
using BCST.Common;
using Bzw.WebLibrary;

namespace Bzw.Inhersits
{
    public partial class MatchList : UiCommon.BasePage
    {
        /// <summary>
        /// Head1 控件。
        /// </summary>
        /// <remarks>
        /// 自动生成的字段。
        /// 要进行修改，请将字段声明从设计器文件移到代码隐藏文件。
        /// </remarks>
        protected global::System.Web.UI.HtmlControls.HtmlHead Head1;

        /// <summary>
        /// webmeta1 控件。
        /// </summary>
        /// <remarks>
        /// 自动生成的字段。
        /// 要进行修改，请将字段声明从设计器文件移到代码隐藏文件。
        /// </remarks>
        protected global::System.Web.UI.UserControl webmeta1;

        /// <summary>
        /// form1 控件。
        /// </summary>
        /// <remarks>
        /// 自动生成的字段。
        /// 要进行修改，请将字段声明从设计器文件移到代码隐藏文件。
        /// </remarks>
        protected global::System.Web.UI.HtmlControls.HtmlForm form1;

        /// <summary>
        /// webtop1 控件。
        /// </summary>
        /// <remarks>
        /// 自动生成的字段。
        /// 要进行修改，请将字段声明从设计器文件移到代码隐藏文件。
        /// </remarks>
        protected global::System.Web.UI.UserControl webtop1;

        /// <summary>
        /// webuserlogin1 控件。
        /// </summary>
        /// <remarks>
        /// 自动生成的字段。
        /// 要进行修改，请将字段声明从设计器文件移到代码隐藏文件。
        /// </remarks>
        protected global::System.Web.UI.UserControl webuserlogin1;

 

        /// <summary>
        /// webservice1 控件。
        /// </summary>
        /// <remarks>
        /// 自动生成的字段。
        /// 要进行修改，请将字段声明从设计器文件移到代码隐藏文件。
        /// </remarks>
        protected global::System.Web.UI.UserControl webservice1;

        /// <summary>
        /// rpNewsList 控件。
        /// </summary>
        /// <remarks>
        /// 自动生成的字段。
        /// 要进行修改，请将字段声明从设计器文件移到代码隐藏文件。
        /// </remarks>
        protected global::System.Web.UI.WebControls.Repeater rpList;

 

        /// <summary>
        /// webfooter1 控件。
        /// </summary>
        /// <remarks>
        /// 自动生成的字段。
        /// 要进行修改，请将字段声明从设计器文件移到代码隐藏文件。
        /// </remarks>
        protected global::System.Web.UI.UserControl webfooter1;

        /// <summary>
        /// anpPageIndex 控件。
        /// </summary>
        /// <remarks>
        /// 自动生成的字段。
        /// 要进行修改，请将字段声明从设计器文件移到代码隐藏文件。
        /// </remarks>
        protected global::Wuqi.Webdiyer.AspNetPager anpPageIndex;

        private int PageIndex
        {
            get
            {
                string tmp = CommonManager.Web.Request("page", "");
                if (string.IsNullOrEmpty(tmp) || !CommonManager.String.IsInteger(tmp))
                    return 1;
                return int.Parse(tmp);
            }
        }

        protected void Page_Load(object sender, EventArgs e)
        {
            SeoSetting(SeoConfig.Config.DefaultSeo);
            	string where = " and startTime>'"+DateTime.Now.AddDays(-7).ToString("yyyy-MM-dd HH:mm:ss")+"'";
			int counts = 0;
			DataTable dt = Utility.SqlHelper.ExecuteDataPager( "Web_VTContestRoom", "ContestID", "*", "ContestID", 1, anpPageIndex.PageSize, PageIndex, out counts, where );
			//WebPager1.ItemCount = counts;
			anpPageIndex.RecordCount = counts;
			anpPageIndex.CurrentPageIndex = PageIndex;
                //DataTable dt =Utility.SqlHelper.ExecuteDataPager DbSession.Default.FromSql("select   * from Web_VTContestRoom where startTime>@NowDate order by StartTime")
                //    .AddInputParameter("@NowDate", DbType.DateTime, DateTime.Now.AddDays(-7).ToString("yyyy-MM-dd HH:mm:ss")).ToDataTable();
                if (dt.Rows.Count > 0)
                {
                    rpList.DataSource = dt;
                    rpList.DataBind();
                }


        }
        
    }
}
